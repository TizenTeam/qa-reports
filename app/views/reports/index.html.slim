- content_for :version_navi do
  #version_navi
    = release_version_navigation(release.name)

#index_page
  table#report_navigation
    thead
      tr.profiles
        th
          a.name href="#"
    tbody
      tr.profiles
        td.testsets
          div
            a.name
            a.compare
            ul.products
              li
                a.name
  a#home_edit_link href='#'
  a#home_edit_done_link.small_btn href='#' Done

javascript:
  index_model = #{{@index_model.to_json}}

coffee:

  group_report_path = (data) ->
    if data.parent_ and data.parent_.name
      group_report_path(data.parent_) + "/#{data.name}"
    else
      "/#{index_model.release}/#{data.name}"

  directives =
    profiles:
      'name@href':    -> group_report_path(this)
      testsets:
        'name@href':  -> group_report_path(this)
        products:
         'name@href': -> group_report_path(this)


  $('#report_navigation').render(index_model, directives)


  $('#report_navigation tbody a.name').each () ->
    $i = $('<input>').addClass('inplace-edit')
      .hide()
    $i.insertAfter $(this)

  $('#home_edit_link').click () ->
    $('#index_page').addClass 'editing'
    $('#index_page.editing #report_navigation tbody a.name').addClass 'editable_text'
    $('a.compare').hide()

  $('#home_edit_done_link').click () ->
    $('#index_page').removeClass 'editing'
    $('#report_navigation tbody a.name').removeClass 'editable_text'
    $('a.compare').show()

  $('#index_page.editing #report_navigation tbody a.name').live 'click', () ->
    $(this).hide()
    $(this).next('input.inplace-edit').show()
    return false

  $('#index_page.editing #report_navigation ul li a').live 'mouseover', () ->
    hw_name = $(this).text()
    $('#index_page.editing #report_navigation ul li a').filter(() ->
      return $(this).text() == hw_name
    ).addClass('to_be_edited')

  $('#index_page.editing #report_navigation ul li a').live 'mouseout', () ->
    $('#index_page.editing #report_navigation ul li a').removeClass('to_be_edited')

