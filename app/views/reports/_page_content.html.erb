
<div class="page_content">

  <%= yield :notification_area %>	

  <% action = controller.action_name 
  if action == 'compare' 
    cache_key = @compare_cache_key
  else
    cache_key = "#{action}_page_#{@test_session.id}"
  end %> 
  <%= cache cache_key do %>

    <%= yield :button_area %>

    <%= render :partial => 'editable_title' %>

    <%= yield :title || render(:partial => 'editable_title') %>

    <div class="report_head">
      <%= yield :table_of_contents %>

      <dl class="meta_info">
        <dt id="report_author">Author:</dt>
        <dd><%= @report.author.name%><br/>
        <span class="un"><%= format_date_to_human_readable @report.created_at %></span>
        </dd>
        <dt>Last modified by:</dt>
        <dd><%= @report.editor.name %><br/>
        <span class="un"><%= format_date_to_human_readable @report.updated_at %></span>
        </dd>
        <%= render :partial => 'editable_date' %>

      </dl>
    </div>
    <%= render :partial => 'editable_text', :locals => {:anchor => 'test_objective', :title => "Test Objective", :field => 'objective'} %>
    <%= render :partial => 'editable_text', :locals => {:anchor => 'build', :title => "Build (image)", :field => 'build'} %>
    <%= render :partial => 'editable_text', :locals => {:anchor => 'environment', :title => "Test Environment", :field => 'environment'} %>
    <%= render :partial => 'editable_text', :locals => {:anchor => 'qa_summary', :title => "Quality Summary", :field => 'qa_summary'} %>


    <%= render :partial => 'reports/test_results' %>


    <%= yield :result_edit_notification %>

    <% if @test_session.has_non_nft? %>

      <h2 id="detailed_results">Detailed Test Results<span class="heading_actions"><%=back_to_top%></span></h2>



      <table class="detailed_results" id="detailed_functional_test_results">    			
        <div class="loading" id="history_loader">
          <strong>Loading history data, please wait…</strong>
        </div>
        <thead>
          <tr>
            <th id="th_test_case">

              <span class="sort">
                <a href="#" class="see_only_failed_button sort_btn active">See only failed</a> 
                <a href="#" class="see_all_button sort_btn">See all</a>
              <%if @history%><a href="#" class="see_history_button sort_btn">See history</a><%end%>
              </span>
            </th>
            <th id="th_result">Result</th>
            <th id="th_notes">Notes</th>
          </tr>
        </thead>

        <%= render :partial => "feature", :collection => @test_session.non_nft_sets %>

      </table>


        <% if @history %>
          <table class="detailed_results history" style="display:none;">
            <thead>
              <tr>
                <th id="th_history_test_case">
                  <span class="sort">
                    <a href="#" class="see_only_failed_button sort_btn">See only failed</a> 
                    <a href="#" class="see_all_button sort_btn">See all</a>
                    <a href="#" class="see_history_button sort_btn active">See history</a>
                  </span>
                </th>
                <%= history_headers(@history) %>
                <th class="th_result">Current</th>
                <th> 				  				  				      

                  <div style="position:relative;"></div>
                </th>
              </tr>
            </thead>

            <%= render :partial => "feature_history", :collection => @test_session.non_nft_sets %>
          </table>
        <% end %>

      <% end %>

      <% if @test_session.has_nft? %>
        <h2 id="detailed_nft_results">Non-functional Test Results<span class="heading_actions"><%=back_to_top%></span></h2>

        <table class="non-functional_results detailed_results">
          <thead>
            <tr>
              <th id="th_nft_test_case">
              </th>
              <th class="th_name">Measurement</th>
              <th class="th_measured">Value</th>
              <th class="th_target">Target</th>    
              <th class="th_limit">Fail limit</th>	
              <th class="th_to_target">% of target</th>  
              <th class="th_result">Result</th>  			     			  
              <th id="th_notes">Notes</th>
            </tr>
          </thead>

          <%= render :partial => "nft_feature", :collection => @test_session.nft_sets %>

        </table>
        
        
        <!-- *************** DUMMY HTML STARTS *******************-->
           <h2 id="detailed_nft_results">Non-functional Test Results (dummy)<span class="heading_actions"><a href="#top">Back to top</a></span></h2> 
         
                <table class="non-functional_results detailed_results history"> 
                  <thead> 
                    <tr> 
                      <th id="th_nft_test_case"> 
                    	  <span class="sort"> 
                            <a href="#" class="see_all_button sort_btn">See latest</a> 
                            <a href="#" class="see_history_button sort_btn active">See history</a> 
                        </span> 
                      </th> 
                      <th class="th_name">Measurement</th> 
                      <th class="th_measured" colspan="6">18/12 – 01/01/2011</th> 
<!--                      <th class="th_target">Target</th>    
                      <th class="th_limit">Fail limit</th>	
                      <th class="th_to_target">% of target</th>  
                      <th class="th_result">Result</th>  	-->		     			  
                     <!-- <th id="th_notes">Notes</th> -->
                    </tr> 
                  </thead> 
         
                  <tbody> 
        <tr class="feature_name" id="test-set-372"> 
        	<td colspan="8"> 
                N/A
        		<a href="#" class="see_all_toggle">+ see passing tests</a> 
        	</td> 
        </tr> 
        </tbody> 
        <tbody> 
        <tr class="testcase multiple_rows even" id="testcase-833" > 
         
          <td class="testcase_name" rowspan="1">simple-case1
            
            
          </td> 
            <td class="testcase_measurement">Current samples<br/><small class="un2">(Based on medians)</small></td> 
            <td class="testcase_graph" colspan="5"> 
            	<a href="" class="nft_series_history_modal_toggle"><img src="/images/dummy_graph.png" alt="dummy graph" /></a>
            </td> 
        </tr> 
        <tr class="testcase multiple_rows" id="testcase-834" > 
         
          <td class="testcase_name" rowspan="5">simple-case2
            
            
          </td> 
          	
            <td class="testcase_measurement">temperature</td> 
            <td class="testcase_graph" colspan="5">
            	<a href="" class="nft_history_modal_graph_toggle"><img src="/images/dummy_graph2.png" alt="dummy graph" /></a>
            	<table class="nft_graph_key_figures"> 
            	  <tr> 
            	    <td class="unit">mA</td> 
            	    <td><span class="unit">min.</span> 478</td> 
            	    <td><span class="unit">avg.</span> 486</td> 
            	    <td><span class="unit">max.</span> 500</td> 
            	    <td><span class="unit">med.</span> 486</td> 
            	  </tr> 
            	</table> 
            </td>	
        </tr> 
        
        <tr class="testcase multiple_rows"  > 
          <td class="testcase_measurement">bandwidth</td> 
          <td class="testcase_graph" colspan="5">
          	<a href="" class="nft_history_modal_graph_toggle"><img src="/images/dummy_graph2.png" alt="dummy graph" /></a>
          	<table class="nft_graph_key_figures"> 
          	  <tr> 
          	    <td class="unit">Mb/s</td> 
          	    <td><span class="unit">min.</span> 78</td> 
          	    <td><span class="unit">avg.</span> 96</td> 
          	    <td><span class="unit">max.</span> 108</td> 
          	    <td><span class="unit">med.</span> 86</td> 
          	  </tr> 
          	</table> 
          </td>    
        </tr> 
        
     	 <tr class="testcase multiple_rows"  >          
          <td class="testcase_measurement">length</td> 
          <td class="testcase_graph" colspan="5">
          	<a href="" class="nft_history_modal_graph_toggle"><img src="/images/dummy_graph2.png" alt="dummy graph" /></a>
          	<table class="nft_graph_key_figures"> 
          	  <tr> 
          	    <td class="unit">m</td> 
          	    <td><span class="unit">min.</span> 23</td> 
          	    <td><span class="unit">avg.</span> 45</td> 
          	    <td><span class="unit">max.</span> 56</td> 
          	    <td><span class="unit">med.</span> 47</td> 
          	  </tr> 
          	</table> 
          </td>              
        </tr> 
            
        <tr class="testcase multiple_rows"  > 
            <td class="testcase_measurement">weight</td> 
            <td class="testcase_graph" colspan="5">
            	<a href="" class="nft_history_modal_graph_toggle"><img src="/images/dummy_graph2.png" alt="dummy graph" /></a>
            	<table class="nft_graph_key_figures"> 
            	  <tr> 
            	    <td class="unit">kg</td> 
            	    <td><span class="unit">min.</span> 90</td> 
            	    <td><span class="unit">avg.</span> 120</td> 
            	    <td><span class="unit">max.</span> 134</td> 
            	    <td><span class="unit">med.</span> 123</td> 
            	  </tr> 
            	</table> 
            </td>
         </tr> 
                      
        </tbody> 
         
         
       </table> 
        <!-- *************** DUMMY HTML ENDS *******************-->
        

      <% end %>


      <%= render :partial => 'editable_text', :locals => {:anchor => 'issue_summary', :title => "Issue Summary", :field => 'issue_summary'} %>

      <%= render :partial => 'reports/file_attachments' %>

      <%= yield :wizard_actions %>

    <% end %>
